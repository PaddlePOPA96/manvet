import{c as S,j as e,f as p,r as x,P as w,T as N}from"./index-ChC7JKR1.js";import{C as k}from"./circle-check-big-BN2ZTvY4.js";/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=S("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);function m({title:a,value:r,color:t,icon:n,isMoney:d}){return e.jsxs("div",{className:`p-4 rounded-xl border shadow-sm hover:shadow-md transition-shadow bg-white/80 flex flex-col items-start justify-between text-left ${t}`,children:[e.jsx("div",{className:"mb-2 text-slate-600",children:n}),e.jsx("span",{className:"text-[11px] font-semibold tracking-wide uppercase text-slate-700",children:a}),e.jsx("span",{className:`${d?"text-lg md:text-xl":"text-2xl"} font-bold mt-1`,children:r})]})}function _({data:a}){const r=a.length>0?Math.max(...a.map(t=>t.revenue)):0;return e.jsx("div",{className:"h-48 flex items-end gap-3",children:a.map(t=>{const n=r?Math.max(8,Math.round(t.revenue/r*100)):0;return e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end",children:[e.jsx("div",{className:"text-[10px] text-gray-500 mb-1",children:p(t.revenue)}),e.jsx("div",{className:"w-full bg-teal-50 border border-teal-100 rounded-md flex items-end justify-center overflow-hidden",children:e.jsx("div",{className:"w-3/4 rounded-md bg-teal-500",style:{height:`${n}%`}})}),e.jsx("div",{className:"mt-1 text-[11px] text-gray-500 text-center",children:t.date.slice(5)})]},t.date)})})}const P="http://localhost:8000";function T(a,r,t){const[n,d]=x.useState({stock_ready:0,qty_sold:0,revenue:0,profit:0,chart_data:[]}),[u,o]=x.useState(!1),[h,c]=x.useState(null);return x.useEffect(()=>{async function f(){o(!0),c(null);try{const s=new URLSearchParams,g=new Date;let i=null,j=g.toISOString().split("T")[0];if(a==="7d"){const l=new Date(g);l.setDate(l.getDate()-6),i=l.toISOString().split("T")[0]}else if(a==="30d"){const l=new Date(g);l.setDate(l.getDate()-29),i=l.toISOString().split("T")[0]}else a==="custom"&&(i=r,j=t);i&&s.append("start_date",i),j&&s.append("end_date",j);const y=localStorage.getItem("vet_token"),b=await fetch(`${P}/api/dashboard?${s.toString()}`,{headers:{Authorization:`Bearer ${y}`,Accept:"application/json"}});if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const v=await b.json();d(v)}catch(s){console.error("Failed to fetch dashboard stats",s),c(s)}finally{o(!1)}}f()},[a,r,t]),{stats:n,loading:u,error:h}}function R({periodPreset:a,periodFrom:r,periodTo:t}){const{stats:n,loading:d,error:u}=T(a,r,t);if(d)return e.jsx("div",{className:"text-center py-10 text-gray-500",children:"Memuat data dashboard..."});if(u)return e.jsx("div",{className:"text-center py-10 text-red-500",children:"Gagal memuat data dashboard."});const{stock_ready:o,qty_sold:h,revenue:c,profit:f,chart_data:s}=n;return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(m,{title:"Stok Ready (Unit)",value:o,color:"bg-blue-50 text-blue-700 border-blue-200",icon:e.jsx(w,{size:20})}),e.jsx(m,{title:"Qty Terjual (Periode)",value:h||0,color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(N,{size:20})}),e.jsx(m,{title:"Omzet Periode",value:p(c||0),color:"bg-teal-50 text-teal-700 border-teal-200",icon:e.jsx(D,{size:20}),isMoney:!0}),e.jsx(m,{title:"Profit Bersih Periode",value:p(f||0),color:"bg-emerald-100 text-emerald-800 border-emerald-300",icon:e.jsx(k,{size:20}),isMoney:!0})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Grafik Penjualan"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Berdasarkan transaksi OUT (SALE/Reseller/Consignment)"})]}),!s||s.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-6",children:"Belum ada data transaksi penjualan."}):e.jsx(_,{data:s})]})]})}export{R as default};
